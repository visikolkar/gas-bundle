"use strict";(self.webpackChunkGAS=self.webpackChunkGAS||[]).push([[964],{1964:(t,e,r)=>{r.r(e),r.d(e,{default:()=>A});var o=r(3433),n=r(5671),i=r(3144),l=r(7326),a=r(136),c=r(2963),u=r(1120),s=r(4942),f=r(5543),p=r.n(f),d=r(9956),v=r(7294),y=r(932),h=r(8977),b=r(7011),S=r(6294),g=r(7679);function E(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function Z(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){(0,s.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=(0,u.Z)(t);if(e){var n=(0,u.Z)(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return(0,c.Z)(this,r)}}var O=function(t){(0,a.Z)(r,t);var e=m(r);function r(t){var i;return(0,n.Z)(this,r),i=e.call(this,t),(0,s.Z)((0,l.Z)(i),"selector",v.createRef()),(0,s.Z)((0,l.Z)(i),"getSelectionAttributes",(function(t){var e=[],r=[];return t.getAttributes&&(e=t.getAttributes().filter((function(t){return t.metadata.get("isDisplayed")}))),t.getPivotAttributes&&(r=t.getPivotAttributes().filter((function(t){return t.metadata.get("isDisplayed")}))),[].concat((0,o.Z)(e),(0,o.Z)(r))})),(0,s.Z)((0,l.Z)(i),"getSelections",(function(t){var e={selectedAttributes:{}};try{if(i.selector&&i.selector.current&&i.selector.current.state&&i.selector.current.state.attributeModelExplorer){var r,o,n=i.selector.current.state.attributeModelExplorer.modelExplorer;if(null!=n&&null!==(r=n.attributeModelExplorer)&&void 0!==r&&r.getSelectedValues)e.userSelection=null==n||null===(o=n.attributeModelExplorer)||void 0===o?void 0:o.getSelectedValues();var l=i.getSelectionAttributes(i.selector.current.state.attributeModelExplorer),a={};l.forEach((function(t){var e=t.getResolvedValue();e&&(a[t.key]=e)})),e.selectedAttributes=Z({},a)}if("fullyResolved"===t.state){var c=[],u={};t.attributes&&t.attributes.forEach((function(t){void 0!==t.resolvedValue&&(u[t.key]=t.resolvedValue),t.isDisplayed&&c.push({attributeKey:t.key,attributeValue:t.resolvedValue})})),e.finalSelection=u}}catch(t){i.setState({localError:!0})}return Z(Z({},e),{},{selectorState:t.state})})),(0,s.Z)((0,l.Z)(i),"onSelectionChange",(function(t){if(t.state){var e,r=t,o=i.props.onChange,n=i.getSelections(r);o&&o((0,s.Z)({},(null===(e=n.finalSelection)||void 0===e?void 0:e.Quantity)||"1",n))}else{var l=i.props.onChange,a=t,c={};(a.Quantity||a.quantity).forEach((function(t){c[t.pivotValue]=i.getSelections(t.resolution)})),l&&l(c)}})),(0,s.Z)((0,l.Z)(i),"onloadSelector",(function(t){if(t.state){var e,r=t,o=i.props.onChange,n=i.getSelections(r);o&&o((0,s.Z)({},(null===(e=n.finalSelection)||void 0===e?void 0:e.Quantity)||"1",n))}else{var l=i.props.onChange,a=t,c={};(a.Quantity||a.quantity).forEach((function(t){c[t.pivotValue]=i.getSelections(t.resolution)})),l&&l(c)}i.setState({onloadSelector:!0})})),(0,s.Z)((0,l.Z)(i),"onSelectorError",(function(t){var e=i.props.onError;e&&e(!1,t)})),r.contextType=h.mn,i.state={localError:!1,onloadSelector:!1},i}return(0,i.Z)(r,[{key:"componentDidUpdate",value:function(t){var e,r=this.props,n=r.customQuantity,i=r.quantityList;t.customQuantity!==n&&n&&i&&(null!==(e=this.selector)&&void 0!==e&&e.current&&this.selector.current.updateHiddenPivotAttribute("Quantity",[].concat((0,o.Z)(i),[n])))}},{key:"render",value:function(){var t=this.props,e=t.productDetails,r=t.quantityList,o=e.productRuleSet,n=e.customization,i=e.defaultSelection,l=this.context.ecxGlobalState,a=this.state,c=a.localError,u=a.onloadSelector,s={};return r&&(s=Z(Z({},i),{},{Quantity:{isHidden:!0,displayPriority:50,isPivot:!0,initialSelection:r}})),c||!o?v.createElement(v.Fragment,null,v.createElement(b.Z,{message:(0,y.TT)(y._.ERROR_MESSAGE_ATTR_SELECTOR,l.locale),shortView:!0})):v.createElement(v.Fragment,null,!u&&v.createElement(S.Z,null),v.createElement(d.Z,{display:u?"block":"none"},v.createElement(d.Z,{className:"webshop-attr-selector",component:"div"},v.createElement(p(),{onLoad:this.onloadSelector,ref:this.selector,product:o,onChange:this.onSelectionChange,customizations:n,onError:this.onSelectorError,errorAlertConfiguration:{showErrorAlert:!1},attributeConfigurations:s,selectorUI:g.Z,selectorUIConfigurations:n,allowDisabledSelection:!0,authToken:""}))))}}]),r}(v.Component);const A=v.memo(O)}}]);